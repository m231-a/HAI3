---
title: Internationalization (@hai3/i18n)
description: Multi-language support with lazy loading
---

# Internationalization (@hai3/i18n)

The `@hai3/i18n` package provides multi-language support with lazy-loaded translation packs, RTL/LTR layouts, and locale-aware formatting.

## Overview

**Package:** `@hai3/i18n`
**Layer:** L1 (SDK)
**Dependencies:** `i18next`, `react-i18next`, `lodash` (no other `@hai3/*` packages)

**Key Features:**
- 36+ language support out of the box
- Lazy-loaded translation bundles
- Per-screenset translations
- RTL/LTR layout switching
- Locale-aware date/number formatting
- TypeScript-safe translation keys
- Fallback language support

## Translation Structure

### File Organization

```
src/translations/
├── en/
│   ├── common.json          # Shared translations
│   ├── auth.json            # Auth screenset
│   ├── dashboard.json       # Dashboard screenset
│   └── settings.json        # Settings screenset
├── es/
│   ├── common.json
│   ├── auth.json
│   └── ...
├── ar/                      # RTL language
│   └── ...
└── index.ts                 # Language registry
```

### Translation Files

```json
// src/translations/en/auth.json
{
  "login": {
    "title": "Sign In",
    "email": "Email Address",
    "password": "Password",
    "submit": "Log In",
    "forgot": "Forgot password?",
    "errors": {
      "invalid": "Invalid email or password",
      "required": "This field is required"
    }
  },
  "signup": {
    "title": "Create Account",
    "submit": "Sign Up"
  }
}
```

### Namespace Structure

Organize translations by screenset:

```typescript
// Namespace matches screenset ID
const namespaces = {
  'common': 'src/translations/{lang}/common.json',
  'auth': 'src/translations/{lang}/auth.json',
  'dashboard': 'src/translations/{lang}/dashboard.json'
};
```

## Setup

### Initialize i18n

```typescript
import { initI18n } from '@hai3/i18n';

const i18n = initI18n({
  defaultLanguage: 'en',
  fallbackLanguage: 'en',
  supportedLanguages: ['en', 'es', 'fr', 'de', 'ar', 'zh'],
  namespaces: ['common', 'auth', 'dashboard'],
  loadPath: '/locales/{{lng}}/{{ns}}.json'
});
```

### Framework Integration

```typescript
import { createHAI3 } from '@hai3/framework';
import { i18nPlugin } from '@hai3/framework/plugins';

const app = createHAI3()
  .use(i18nPlugin({
    defaultLanguage: 'en',
    supportedLanguages: ['en', 'es', 'fr']
  }))
  .build();
```

## Using Translations

### Basic Usage

```typescript
import { useTranslation } from '@hai3/i18n';

function LoginScreen() {
  const { t } = useTranslation('auth');

  return (
    <form>
      <h1>{t('login.title')}</h1>
      <input placeholder={t('login.email')} />
      <input placeholder={t('login.password')} type="password" />
      <button>{t('login.submit')}</button>
    </form>
  );
}
```

### Interpolation

```typescript
// Translation: "Welcome back, {{name}}!"
const { t } = useTranslation('common');

<h1>{t('welcome.message', { name: user.name })}</h1>
// Output: "Welcome back, John!"
```

### Pluralization

```json
{
  "items": {
    "count_one": "{{count}} item",
    "count_other": "{{count}} items"
  }
}
```

```typescript
<p>{t('items.count', { count: 1 })}</p>  // "1 item"
<p>{t('items.count', { count: 5 })}</p>  // "5 items"
```

### Namespaces

```typescript
// Load multiple namespaces
const { t } = useTranslation(['common', 'auth']);

<h1>{t('common:app.title')}</h1>
<button>{t('auth:login.submit')}</button>
```

### Fallback Keys

```typescript
// Use fallback if key missing
const { t } = useTranslation('auth');

<span>{t('login.helper', 'Need help?')}</span>
```

## Language Switching

### Programmatic Switching

```typescript
import { useTranslation } from '@hai3/i18n';

function LanguageSwitcher() {
  const { i18n } = useTranslation();

  const changeLanguage = (lang: string) => {
    i18n.changeLanguage(lang);
  };

  return (
    <select
      value={i18n.language}
      onChange={(e) => changeLanguage(e.target.value)}
    >
      <option value="en">English</option>
      <option value="es">Español</option>
      <option value="fr">Français</option>
    </select>
  );
}
```

### Language Detection

```typescript
initI18n({
  detection: {
    // Order of detection
    order: ['querystring', 'cookie', 'localStorage', 'navigator'],
    // Cookie name
    lookupCookie: 'i18next',
    // LocalStorage key
    lookupLocalStorage: 'i18nextLng'
  }
});
```

## RTL Support

### RTL Languages

```typescript
const rtlLanguages = ['ar', 'he', 'fa', 'ur'];

const isRTL = rtlLanguages.includes(i18n.language);
```

### Layout Direction

```typescript
import { useTranslation } from '@hai3/i18n';

function App() {
  const { i18n } = useTranslation();
  const dir = i18n.dir(); // 'ltr' or 'rtl'

  return (
    <div dir={dir}>
      {/* Content automatically flows RTL or LTR */}
    </div>
  );
}
```

### RTL CSS

```css
/* Automatic direction-aware styles */
[dir="rtl"] .margin-start {
  margin-inline-start: 1rem;
}

[dir="ltr"] .margin-start {
  margin-inline-start: 1rem;
}
```

## Locale Formatting

### Date Formatting

```typescript
import { formatDate } from '@hai3/i18n';

const date = new Date();
const formatted = formatDate(date, i18n.language);
// en: "January 30, 2026"
// es: "30 de enero de 2026"
// ar: "٣٠ يناير ٢٠٢٦"
```

### Number Formatting

```typescript
import { formatNumber } from '@hai3/i18n';

const price = 1234.56;
const formatted = formatNumber(price, i18n.language, {
  style: 'currency',
  currency: 'USD'
});
// en: "$1,234.56"
// es: "1.234,56 $"
// de: "1.234,56 $"
```

### Relative Time

```typescript
import { formatRelative } from '@hai3/i18n';

const timestamp = Date.now() - 3600000; // 1 hour ago
const formatted = formatRelative(timestamp, i18n.language);
// en: "1 hour ago"
// es: "hace 1 hora"
// fr: "il y a 1 heure"
```

## Adding Languages

### Register New Language

```typescript
// src/translations/index.ts
import { registerLanguage } from '@hai3/i18n';

registerLanguage({
  code: 'pt',
  name: 'Português',
  nativeName: 'Português',
  dir: 'ltr',
  namespaces: ['common', 'auth', 'dashboard']
});
```

### Create Translation Files

```json
// src/translations/pt/common.json
{
  "app": {
    "title": "Minha Aplicação",
    "welcome": "Bem-vindo"
  }
}
```

### Load Translations

```typescript
import commonPt from './translations/pt/common.json';
import authPt from './translations/pt/auth.json';

i18n.addResourceBundle('pt', 'common', commonPt);
i18n.addResourceBundle('pt', 'auth', authPt);
```

## Lazy Loading

Load translations on demand:

```typescript
initI18n({
  lazy: true,
  backend: {
    loadPath: '/locales/{{lng}}/{{ns}}.json',
    // Load only when needed
    allowMultiLoading: false
  }
});

// Preload specific namespaces
i18n.loadNamespaces(['dashboard'], (err) => {
  if (!err) {
    console.log('Dashboard translations loaded');
  }
});
```

## Type Safety

### Define Translation Keys

```typescript
// src/types/i18n.d.ts
import 'react-i18next';

declare module 'react-i18next' {
  interface CustomTypeOptions {
    defaultNS: 'common';
    resources: {
      common: typeof import('../translations/en/common.json');
      auth: typeof import('../translations/en/auth.json');
    };
  }
}
```

### Type-Safe Usage

```typescript
// Now TypeScript validates translation keys
const { t } = useTranslation('auth');

t('login.title');      // ✅ Valid
t('login.invalid');    // ❌ TypeScript error
```

## Best Practices

**Keep Keys Semantic:**
```typescript
// ✅ Good: Semantic keys
t('auth.login.submit')

// ❌ Bad: Generic keys
t('button1')
```

**Namespace by Feature:**
```
✅ Good: Feature-based
- common.json (shared)
- auth.json (login, signup)
- dashboard.json (widgets, charts)

❌ Bad: Type-based
- buttons.json
- labels.json
```

**Use Interpolation:**
```typescript
// ✅ Good: Dynamic values
t('welcome.message', { name: user.name })

// ❌ Bad: Concatenation
t('welcome.hello') + ' ' + user.name
```

**Avoid HTML in Translations:**
```typescript
// ✅ Good: Component composition
<p>{t('auth.terms.prefix')} <Link>{t('auth.terms.link')}</Link></p>

// ❌ Bad: HTML in translation
t('auth.terms.html') // "I agree to <a>terms</a>"
```

## Testing

### Mock Translations

```typescript
import { renderWithI18n } from '@hai3/i18n/testing';

test('renders translated text', () => {
  const { getByText } = renderWithI18n(<LoginScreen />, {
    language: 'en',
    resources: {
      en: {
        auth: {
          login: { title: 'Sign In' }
        }
      }
    }
  });

  expect(getByText('Sign In')).toBeInTheDocument();
});
```

### Test Multiple Languages

```typescript
['en', 'es', 'fr'].forEach(lang => {
  test(`renders correctly in ${lang}`, () => {
    renderWithI18n(<Component />, { language: lang });
    // Assertions...
  });
});
```

## Related Documentation

- [React Layer](/hai3/architecture/react)
- [SDK Layer](/hai3/architecture/layers)
- [Manifest - V#9 i18n](/hai3/architecture/manifest#v9-internationalization-localization)
- [TERMINOLOGY](/TERMINOLOGY#internationalization)
